<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shooting Game</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
    }

    canvas {
      display: block;
      background-color: black;
      margin: auto;
    }

    #restartBtn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 15px 30px;
      font-size: 18px;
      background-color: white;
      color: black;
      border: none;
      border-radius: 10px;
      display: none;
      z-index: 1;
    }

    .controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-around;
      z-index: 2;
    }

    .controls button {
      width: 80px;
      height: 80px;
      font-size: 20px;
      border-radius: 50%;
      background-color: white;
      border: none;
    }

  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <button id="restartBtn">Restart Game</button>

  <!-- Mobile Controls -->
  <div class="controls">
    <button id="leftBtn">‚è™</button>
    <button id="shootBtn">üî´</button>
    <button id="rightBtn">‚è©</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const restartBtn = document.getElementById("restartBtn");

    const leftBtn = document.getElementById("leftBtn");
    const rightBtn = document.getElementById("rightBtn");
    const shootBtn = document.getElementById("shootBtn");

    let cw = window.innerWidth;
    let ch = window.innerHeight;

    canvas.width = cw;
    canvas.height = ch;

    const blockSize = Math.floor(canvas.width / 6); // scalable block
    const fps = 60;
    const enemySpeed = blockSize / fps; // 1 block per second
    let player, bullets, enemies, keys, score, highScore, gameOver;
    let lastEnemySpawnTime = 0;

    function initGame() {
      player = {
        x: canvas.width / 2 - blockSize / 2,
        y: canvas.height - blockSize * 1.5,
        width: blockSize,
        height: blockSize,
        color: "white",
        speed: blockSize / 5
      };

      bullets = [];
      enemies = [];
      keys = {};
      score = 0;
      highScore = parseInt(localStorage.getItem("highScore")) || 0;
      gameOver = false;
      lastEnemySpawnTime = 0;
    }

    function drawRect(obj) {
      ctx.fillStyle = obj.color;
      ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
    }

    function drawScore() {
      ctx.fillStyle = "white";
      ctx.font = `${blockSize / 2}px Arial`;
      ctx.fillText(`Score: ${score}`, 10, blockSize / 1.5);
      ctx.fillText(`High: ${highScore}`, 10, blockSize);
    }

    function isColliding(a, b) {
      return (
        a.x < b.x + b.width &&
        a.x + a.width > b.x &&
        a.y < b.y + b.height &&
        a.y + a.height > b.y
      );
    }

    function updateGame() {
      if (keys["ArrowLeft"] && player.x > 0) {
        player.x -= player.speed;
      }
      if (keys["ArrowRight"] && player.x < canvas.width - player.width) {
        player.x += player.speed;
      }

      // Bullet shoot
      if (keys["Space"]) {
        bullets.push({
          x: player.x + player.width / 2 - 5,
          y: player.y,
          width: 10,
          height: 20,
          color: "white"
        });
        keys["Space"] = false;
      }

      // Update bullets
      bullets.forEach((bullet, i) => {
        bullet.y -= 10;
        if (bullet.y < 0) bullets.splice(i, 1);
      });

      // Spawn one block per second, left or right
      const now = Date.now();
      if (now - lastEnemySpawnTime > 1000) {
        const leftOrRight = Math.random() < 0.5 ? 0 : canvas.width - blockSize;
        enemies.push({
          x: leftOrRight,
          y: 0,
          width: blockSize,
          height: blockSize,
          color: "red"
        });
        lastEnemySpawnTime = now;
      }

      // Update enemies
      enemies.forEach((enemy, i) => {
        enemy.y += enemySpeed;

        if (enemy.y + enemy.height >= canvas.height) endGame();
        if (isColliding(player, enemy)) endGame();

        // Bullet hit
        bullets.forEach((bullet, j) => {
          if (isColliding(bullet, enemy)) {
            enemies.splice(i, 1);
            bullets.splice(j, 1);
            score += 10;
            if (score > highScore) {
              highScore = score;
              localStorage.setItem("highScore", highScore);
            }
          }
        });
      });
    }

    function endGame() {
      gameOver = true;
      restartBtn.style.display = "block";
    }

    function gameLoop() {
      if (!gameOver) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        updateGame();
        drawRect(player);
        bullets.forEach(drawRect);
        enemies.forEach(drawRect);
        drawScore();
        requestAnimationFrame(gameLoop);
      }
    }

    // Desktop controls
    window.addEventListener("keydown", e => {
      keys[e.code] = true;
    });
    window.addEventListener("keyup", e => {
      keys[e.code] = false;
    });

    // Mobile controls
    leftBtn.addEventListener("touchstart", () => keys["ArrowLeft"] = true);
    leftBtn.addEventListener("touchend", () => keys["ArrowLeft"] = false);

    rightBtn.addEventListener("touchstart", () => keys["ArrowRight"] = true);
    rightBtn.addEventListener("touchend", () => keys["ArrowRight"] = false);

    shootBtn.addEventListener("touchstart", () => keys["Space"] = true);

    // Restart
    restartBtn.addEventListener("click", () => {
      initGame();
      restartBtn.style.display = "none";
      gameLoop();
    });

    // Initialize
    initGame();
    gameLoop();
  </script>
</body>
</html>
