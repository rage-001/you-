<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Responsive Shooting Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: black;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
    }

    #scoreboard {
      font-size: 18px;
      margin: 10px;
    }

    canvas {
      background-color: #000;
      display: block;
      max-width: 100vw;
      max-height: 70vh;
      width: 100%;
      height: auto;
      border: 2px solid white;
    }

    #restartButton {
      margin: 15px;
      padding: 12px 24px;
      font-size: 18px;
      background-color: white;
      color: black;
      border: none;
      cursor: pointer;
      display: none;
    }

    #mobileControls {
      display: flex;
      justify-content: space-between;
      width: 100%;
      padding: 10px;
      position: fixed;
      bottom: 0;
      left: 0;
      background-color: rgba(0, 0, 0, 0.8);
      z-index: 10;
    }

    .btn {
      flex: 1;
      margin: 0 5px;
      padding: 20px;
      font-size: 26px;
      background-color: white;
      color: black;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    .btn:active {
      background-color: gray;
    }

    @media (min-width: 768px) {
      #mobileControls {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div id="scoreboard">Score: 0 | High Score: 0</div>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <button id="restartButton">Restart Game</button>

  <!-- Mobile Buttons -->
  <div id="mobileControls">
    <button class="btn" id="leftBtn">‚¨ÖÔ∏è</button>
    <button class="btn" id="shootBtn">üî´</button>
    <button class="btn" id="rightBtn">‚û°Ô∏è</button>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreboard = document.getElementById('scoreboard');
    const restartButton = document.getElementById('restartButton');

    // Resize canvas to fit screen width
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight * 0.7;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const player = {
      x: canvas.width / 2 - 25,
      y: canvas.height - 60,
      width: 50,
      height: 50,
      color: 'white',
      speed: 6
    };

    let bullets = [];
    let enemies = [];
    let keys = {};
    let score = 0;
    let highScore = localStorage.getItem('highScore') ? parseInt(localStorage.getItem('highScore')) : 0;
    let shootCooldown = 0;
    let gameRunning = true;
    let enemySpeed = 2;

    // Movement keys
    window.addEventListener('keydown', e => keys[e.code] = true);
    window.addEventListener('keyup', e => keys[e.code] = false);

    // Mobile controls
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');
    const shootBtn = document.getElementById('shootBtn');

    let leftPressed = false;
    let rightPressed = false;
    let shootPressed = false;

    leftBtn.addEventListener('touchstart', () => leftPressed = true);
    leftBtn.addEventListener('touchend', () => leftPressed = false);

    rightBtn.addEventListener('touchstart', () => rightPressed = true);
    rightBtn.addEventListener('touchend', () => rightPressed = false);

    shootBtn.addEventListener('touchstart', () => shootPressed = true);
    shootBtn.addEventListener('touchend', () => shootPressed = false);

    function gameLoop() {
      if (!gameRunning) return;
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    function update() {
      // Difficulty: increase every 100 points
      enemySpeed = 2 + Math.floor(score / 100);

      // Move player
      if (keys['ArrowLeft'] || leftPressed) player.x -= player.speed;
      if (keys['ArrowRight'] || rightPressed) player.x += player.speed;
      player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));

      // Shoot bullets
      if ((keys['Space'] || shootPressed) && shootCooldown <= 0) {
        bullets.push({
          x: player.x + player.width / 2 - 2.5,
          y: player.y,
          width: 5,
          height: 10,
          color: 'white'
        });
        shootCooldown = 15;
      }
      if (shootCooldown > 0) shootCooldown--;

      // Update bullets
      bullets = bullets.filter(b => b.y > 0);
      bullets.forEach(b => b.y -= 7);

      // Spawn enemies
      if (Math.random() < 0.03) {
        enemies.push({
          x: Math.random() * (canvas.width - 50),
          y: 0,
          width: 50,
          height: 50,
          color: 'red'
        });
      }

      // Update enemies
      for (let i = enemies.length - 1; i >= 0; i--) {
        enemies[i].y += enemySpeed;

        if (enemies[i].y + enemies[i].height >= canvas.height) {
          endGame();
          return;
        }

        if (isColliding(enemies[i], player)) {
          endGame();
          return;
        }

        for (let j = bullets.length - 1; j >= 0; j--) {
          if (isColliding(enemies[i], bullets[j])) {
            enemies.splice(i, 1);
            bullets.splice(j, 1);
            score += 10;
            updateScoreboard();
            return;
          }
        }
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x, player.y, player.width, player.height);

      bullets.forEach(b => {
        ctx.fillStyle = b.color;
        ctx.fillRect(b.x, b.y, b.width, b.height);
      });

      enemies.forEach(e => {
        ctx.fillStyle = e.color;
        ctx.fillRect(e.x, e.y, e.width, e.height);
      });
    }

    function isColliding(a, b) {
      return a.x < b.x + b.width &&
             a.x + a.width > b.x &&
             a.y < b.y + b.height &&
             a.y + a.height > b.y;
    }

    function endGame() {
      gameRunning = false;
      restartButton.style.display = 'inline-block';
      if (score > highScore) {
        highScore = score;
        localStorage.setItem('highScore', highScore);
      }
    }

    function restartGame() {
      bullets = [];
      enemies = [];
      score = 0;
      player.x = canvas.width / 2 - 25;
      gameRunning = true;
      shootCooldown = 0;
      restartButton.style.display = 'none';
      updateScoreboard();
      requestAnimationFrame(gameLoop);
    }

    restartButton.addEventListener('click', restartGame);

    function updateScoreboard() {
      scoreboard.textContent = `Score: ${score} | High Score: ${highScore}`;
    }

    updateScoreboard();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
